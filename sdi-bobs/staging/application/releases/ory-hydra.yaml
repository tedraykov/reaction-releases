apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: hydra
  namespace: staging
spec:
  skipCRDs: true
  interval: 3m
  chart:
    spec:
      chart: "./charts/ory-hydra"
      sourceRef:
        kind: GitRepository
        name: flux2-sync
        namespace: flux
  values:
    hydra:
      autoMigrate: true
      config:
        serve:
          public:
            cors:
              allowed_origins:
                - https://admin-staging.bobs-test.io
                - https://staging.bobs-test.io
              enabled: true
        urls:
          consent: https://staging.bobs-test.io/private/consent
          error: https://staging.bobs-test.io/signin
          login: https://staging.bobs-test.io/signin
          logout: https://staging.bobs-test.io/logout
          self:
            issuer: https://auth-staging.bobs-test.io
    sealedSecrets:
      dsn: AgAtZpBCVquHHlhb4xOnHvqnD2S/PGZb0yAd/4cQ8+HU8A8lNIgJwu7qBZ8ATXc3EWTIcJvokxEJyRZDpeBCAYptNyl57OWq2AbdDA1OiMQK0Vx927VzZPUG9YsLgwDvBFtWcBB90OMY5hwA601pou6bJz5wpW7u7UMxxTqa53xnQduu53InBM4FmyJza/cuyXZGOznvxb/B1mhc/BsgzLLPQ20xY5f/8dTNehct0hGPyfhwkINoUqp5pI1wZeeWkQXQJr+ri/AbxG3acCCfVv8R9farInbU6JwWqCNISjU2qkwdzQtznQN7boVlX/xywV5y5qV6c7rEybuNwT/Kn+FzZ/Di6dhOgsIC2yYOnVd3QxYHpsPqPHfNjwp8ne19t7ZYSI6ZEImINgwmppgdbAG9l6MGXvl8frvmwqY5ILnB494YLWWSqGTztrCiIDy4IRiY4sjkA/a+5E4V9zamAp6fyzrblC7iOdgeGVdsbJisC306ro2CvuHJilLyPACi6fxVKeSWWSWGWaznTkvTOj/Hh/y8gu5A8zBKuikpFR3IRWrnIMPiQRMdXiv3/oMI1hX4UjZfZSW9O3/3zkp+o4sInSj4xcVUd2KtUm/QwFxDSdfXtEatlkprPGseBdgOT0bT8NhxsyBLjZBnE8hyn88rUWx9YQn7NfwDLJmIetjd0nG9ieTYEnE+Zwr6DpYrbULqcFBec6qfsucJd+PRg2jk3pFQXv46+OhCHooi6cB/LMlPsx3X6o12J/iQ79aiCMeufD4c2y8ghW9hq+xHIlWEZARBpyBE9kTW27Turg2yQea90e1UE7oyxH7LshH08tHGklg4
      secretsCookie: AgB+ldbOeRzg3cQIqnx7WgDfxVoucAoTIBh3MD2yNH2fVI3skFCCHWj8x8oswZrI1zuM6Dn+qA5fgcm8Et8DhZUoDF1GXreR/NLwhRaq718l3M0y9ihFO0rF6uCAY+b4FZ+UtFdfK3KylR+Q7qj2mtl3vpdmLGfyuzDIu9LBh5UVz2VZn8DRjt8kg7dmpi5UJDbhIodApnrPeE0vw69XNesXf2rG5bNlNurIBhqEWh1KOQG8cLE82dzUM5dMfxnOvIOyWG4zDxWB3T9RzT3v0hIIvvFrzl/o+v7yRp3xrZJrTZcdzyS5sAHwAr+c7WuUokmX1GBe1ewNBImjPL0+c0xpJixyeFtSQyZxB0sOXHRumBDZHQgLaB3LPqk/OZ2ZyA9PWjU8GlaXM+dTkmThmIHWlx/by+k0xXJy/3ecsjliluPFG4sLpfy46pup4pC+QrAXQSWBBfGV6h0k45miiaqTM3BAruqv5srfVx8mAXDScY8NViYkIxoEuracKtbiAaFgEMnB/WpeBpX8J4rMmaBlkPsAtId4u1Delr9beLLAjkOTkh5b+RfTJDbzywTM/juwXDx5Nr1xesJywVuInsgdeYPI7glFTdWtB8hG+rd0NcvECk1kOvgTBy/6A0yzr7wDaXIMPMlbOkIv9eqUPJ0RYd8y46K0j0aS4g4M5+sQYScv2vDTp0WFJR3EKhdks8eYExMUCKjey3g9lWo4cgG3IyrlNR6Ay0tbOjjb/EQfAw==
      secretsSystem: AgBypueLfwfekD6/Vm4VelnoQjYuUit0yDuVuX/i331G5OVk3fE515WITEoKYz8ljF5XtS+IU0Zm3iF93oNcdckLtdH6y3szTYkNZ1jpI7/W/tzyZuhZTKkbb18r7/koiRut9RTsIClGNzJt9aV2qydHcJ5RL41yy+NqFEJ+bfz2zEyRUhBQKTO6UlDAns5BGO+1PnR0y7OgOVhv+5QlurYems2bSCVEXpYYbZFkhB1zWeXXCZtDri+U6jO1F8nGcefdrwY9PIGrS3B2e0UAqmeVcQJiElgknFRlwBfS5lp20+9da80zBZHHBUvDZiS3xo7QWfMhuYRLijWwvpW+kvIlFSt3CJtzVsn+5nGD/b7wBhaxyu3Gq2UqP0qdJL59xgY2NEd7U7rzd0it1zT1L9jwCJo38MWhQe9Wke9o1HVA5rSJxZ9VQWY0vpeLUj4NLS8Xsv0FRJK9lI4mAEUm3SWc2ZVmdhcvLyd6tnGj++O9Y3wp0W7IoGao7yMgezKtfUW5Uq7wRjA9ahAUeOT1SraVtCbX5cFpMT627FUUkuscsJJSu/Vx8frulXsToa+AnCgsQOGwtWV6ArtP+Y2nCvwMVwXeP22myE/aNAfme1RroFqnWMwB2GT0Vc0cODtA9OmK3GhSB1sR3j8OdEfsBgrZPElf+Ivabrv4QZb7MwtoA4olE6NSs7260eWnUY5kHdZR6JPDXXdbg6+qOBOS/kjIPbO7KFZyNEpTr6sXZX8kag== 
    maester:
      enabled: false
    image:
      repository: oryd/hydra
      tag: v1.4.6
    ingress:
      public:
        enabled: true
        annotations:
            ingress.kubernetes.io/ssl-redirect: 'false'
            kubernetes.io/ingress.class: nginx 
        hosts:
          - host: auth-staging.bobs-test.io
            paths:
            - /